## AOP ##

诸如日志、事务管理和安全这类的系统服务经常融入到核心业务逻辑的组件中去，这些系统服务被称为**横切关注点**。将这些横切关注点与业务逻辑相分离正是面向切面编程（AOP）所要解决的。依赖注入有助于应用对象之间的解耦，而 AOP 可以实现横切关注点与它们所影响的对象之间的解耦。

AOP 是对 OOP 的补充，切面提供了取代继承和委托的另一种选择。横切关注点可以被模块化特殊的类，这些类被称为切面。这样一来，每个关注点都只集中于一处，而不是分散到多处代码中，同时，服务模块更简洁，只包含核心功能的代码，而次要关注点的代码被转移到切面中了。


### AOP 术语

* 增强/通知（Advice）
 
	增强定义了切面在何时使用。Spring 切面可以应用5种类型的增强：
	* Before 在方法被调用之前调用增强
	* After 在方法完成之后调用增强，无论方法执行是否成功
	* After-returning 在方法成功执行之后调用增强
	* After-throwing 在方法抛出异常后调用增强
	* Around 包裹被增强的方法，在方法调用之前和之后执行自定义的行为

* 连接点（Joinpoint）

	在应用执行过程中能够插入切面的一个点，可以是调用方法时、抛出异常时、甚至修改一个字段时。

* 切入点（Pointcut）

	真正插入增强的连接点。一个切面并不需要通知应用的所有连接点，切点有助于缩小切面所通知连接点的范围。通常使用明确的类和方法名称来指定这些切点，或是利用正则表达式定义匹配的类和方法名称模式来指定这些切点。

* 切面（Aspect）
 
	切面是增强和切点的结合，它们共同定义了关于切面的全部内容——它是什么在何时和何处完成什么功能。

* 目标对象（Target）

	被 AOP 框架进行增强处理的对象，也被称为被增强的对象。如果 AOP 框架是通过运行时代理来实现的，那么这个对象将是一个被代理的对象。

* 织入（Weaving）

	是将切面应用到目标对象来创建新的代理对象的过程，切面在指定的连接点被织入到目标对象中。在目标对象的生命周期里有多个点可以进行织入：
	* 编译期 切面在目标类编译时被织入，需要特殊的编译期。（如 AspectJ）
	* 类加载期 切面在目标类加载到 JVM 时被织入，需要特殊的 ClassLoader（如 CGLIB）
	* 运行期 切面在应用运行的某个时刻被织入，在织入切面时，AOP 容器会为目标对象动态地创建一个代理对象。Spring AOP 是在运行时完成织入的。

* AOP 代理
 
	AOP 框架创建的对象，也就是对目标对象的加强。Spring 中的 AOP 代理既可以是 JDK 动态代理，也可以是 CGLIB 代理。前者为实现接口的目标对象的代理，后者为不实现接口的目标对象的代理。

### Spring 对 AOP 的支持

Spring 对 AOP 的支持局限于方法拦截，所创建的增强都是用标准的 Java 类编写的，定义增强所应用的切点通常在 Spring 配置文件里采用 XML 来编写的。Spring 在运行期将切面织入到 Spring 管理的 Bean 中，代理类封装了目标类，并拦截被通知的方法的调用，再将调用转发给真正的目标 Bean。当拦截到方法调用时，在调用目标 Bean 方法之前，代理会执行切面逻辑。


